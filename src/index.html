<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Jotter</title>
</head>

<body>
  <div class="container-fluid px-0">
    <div class="row">
      <div class="col">
        <div class="input-group">
          <input type="text" class="form-control" id="noteSubjectInput" placeholder="Note Subject" tabindex="1">
          <button class="btn btn-primary mx-1" type="button" id="noteSubmitButton" tabindex="3">Submit</button>
          <button class="btn btn-secondary btn-sm" type="button" id="noteClearButton" tabindex="4">Clear</button>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <textarea class="form-control" id="noteDetailsInput" rows="4" tabindex="2"></textarea>
      </div>
    </div>
  </div>

  <script>
    const submitButton = document.getElementById('noteSubmitButton');
    const clearButton = document.getElementById('noteClearButton');

    const subjectInput = document.getElementById('noteSubjectInput');
    const detailsInput = document.getElementById('noteDetailsInput');

    subjectInput.focus();

    const handleKeydown = (e) => {
      switch (e.key) {
        case 'Escape':
          window.electronApi.hideJotterWindow();
          break;
        case 'Enter':
          if (e.metaKey) { // e.metaKey is true if command key is pressed (cmd+enter detection)
            submitNote();
          }
          break;
      }
    };

    const submitNote = () => {
      console.log(`subject: ${subjectInput.value}`);
      console.log(`details: ${detailsInput.value}`);

      detailsInput.value = '';
      subjectInput.select(); // Leave the subject intact but highlighted for potential reuse in the next note.

      window.electronApi.hideJotterWindow();
    };

    const clearNote = () => {
      detailsInput.value = '';
      subjectInput.select();
    };

    window.addEventListener('keydown', handleKeydown, true);
    submitButton.addEventListener('click', submitNote);
    clearButton.addEventListener('click', clearNote);
  </script>
</body>

</html>